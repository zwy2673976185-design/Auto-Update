<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>悬浮窗+自动更新（稳定基础版）</title>
    <style>
        /* 主体内容容器 */
        #latest-html-container {
            width: 100%; height: 100vh; overflow-y: auto; position: absolute; top: 0; left: 0;
            z-index: 1; background: #f5f5f5;
        }
        /* 更新提示 */
        #update-notice {
            position: fixed; top: 20px; left: 50%; transform: translateX(-50%);
            padding: 10px 20px; background: #2563eb; color: #fff; border-radius: 6px;
            z-index: 99; display: none;
        }
        /* 悬浮球 */
        .float-btn {
            position: fixed; right: 20px; bottom: 20px;
            width: 60px; height: 60px; border-radius: 50%;
            background: url(https://i.imgs.ovh/2025/09/28/75fraO.jpeg) no-repeat center;
            background-size: cover; border: none; box-shadow: 0 3px 10px rgba(0,0,0,0.2);
            cursor: pointer; z-index: 1002;
        }
        /* 悬浮窗 */
        .float-window {
            position: fixed; right: 20px; bottom: 100px;
            width: 280px; height: 250px; background: #fff;
            border-radius: 10px; box-shadow: 0 3px 15px rgba(0,0,0,0.1);
            display: none; z-index: 1001;
        }
        .float-window.active { display: block; }
        /* 悬浮窗头部 */
        .window-header {
            padding: 12px 15px; background: #2563eb; color: #fff;
            display: flex; justify-content: space-between; align-items: center;
        }
        .modal-back {
            background: transparent; border: none; color: #fff;
            font-size: 18px; cursor: pointer;
        }
        /* 功能按钮区 */
        .func-buttons {
            padding: 10px; height: calc(100% - 42px); overflow-y: auto;
        }
        .func-btn {
            display: block; width: 100%; padding: 10px; margin: 8px 0;
            border: none; border-radius: 6px; background: #f8f9fa;
            text-align: left; font-size: 14px; cursor: pointer;
        }
    </style>
</head>
<body>
    <div id="latest-html-container">
        <div style="height: 100%; display: flex; align-items: center; justify-content: center;">
            <p style="font-size: 16px; color: #666;">加载最新内容中...</p>
        </div>
    </div>
    <div id="update-notice">已更新到最新文件</div>

    <button class="float-btn" id="floatBtn"></button>
    <div class="float-window" id="floatWindow">
        <div class="window-header">
            功能面板
            <button class="modal-back" id="modalBack">×</button>
        </div>
        <div class="func-buttons">
            <button class="func-btn" id="btnMy">我的</button>
            <button class="func-btn" id="btnNotice">公告</button>
            <button class="func-btn" id="btnContact">联系作者</button>
            <button class="func-btn" id="btnSetting">设置</button>
        </div>
    </div>

    <script>
        // 悬浮窗核心逻辑
        const floatBtn = document.getElementById('floatBtn');
        const floatWindow = document.getElementById('floatWindow');
        const modalBack = document.getElementById('modalBack');

        // 显示/隐藏悬浮窗
        floatBtn.addEventListener('click', () => {
            floatWindow.classList.toggle('active');
        });

        // 关闭悬浮窗
        modalBack.addEventListener('click', () => {
            floatWindow.classList.remove('active');
        });

        // 自动更新逻辑
        const container = document.getElementById('latest-html-container');
        const notice = document.getElementById('update-notice');
        const RENDER_DOMAIN = 'https://auto-update-z5j4.onrender.com';

        // 加载HTML内容
        function loadHtml(content) {
            container.innerHTML = content;
            notice.style.display = 'block';
            setTimeout(() => notice.style.display = 'none', 3000);
        }

        // WebSocket监听更新
        let ws = new WebSocket(`wss://${RENDER_DOMAIN}/github-webhook`);
        ws.onmessage = (e) => loadHtml(e.data);
        ws.onclose = () => setTimeout(() => ws = new WebSocket(`wss://${RENDER_DOMAIN}/github-webhook`), 5000);
    </script>
</body>
</html>
